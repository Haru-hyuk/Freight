# 화물 운송 플랫폼 프로젝트 구조 정리 (최종 통합본)

---

## 1. 프로젝트 한 줄 정의

> **본 프로젝트는 화주가 운송 조건을 제시하고,  
> 기사가 자신의 차량 상태·적재 용량·경로 효율을 기준으로  
> 단건 또는 다건(합짐) 운송을 계획하여 매칭한 뒤  
> 매칭 확정 후 결제하는 화물 운송 플랫폼이다.**

---

## 2. 핵심 설계 철학 (최종)

### ① 계약 단위는 무조건 `매칭`
- 결제·운송·정산은 모두 매칭 기준

### ② 기본은 단순, 확장은 조건부
- 기본: 즉시 수락 → 매칭
- 예외: 가격 협상 / 합짐 / 귀가노선

### ③ 합짐은 “운송 중 끼워 넣기”가 아니다
- **운송 시작 전, 기사 주도 계획형 다건 운송**

### ④ 모든 예외는 “사전 합의”
- 합짐 가능 여부
- 가격 협상 여부

 전부 **견적/매칭 시점에 명시**

---

## 3. 사용자 역할별 책임

### 1️⃣ 화주
- 화물 등록
- 견적서 작성
    - 희망 금액
    - 화물 정보
    - 체크리스트
    -  **합짐 가능 여부 체크**
- 기사 가격 협상 제안 수락/거절
- 매칭 확정 후 결제
- 운송 상태 확인
- 이행 확인 및 정산 확인

---

### 2️⃣ 기사
- 차량 등록 (적재 용량 포함)
- 견적 리스트 조회
- 차량 용량 기준 운송 계획 수립
    - 단건
    - **다건(합짐) 조합**
    - 귀가노선 조합
- 조건 만족 시 즉시 수락
- 가격이 과도하게 낮을 경우만 협상 요청
- 매칭 확정
- 운송 수행
- GPS 위치 전송
- 수익 확인

---

### 3️⃣ 관리자
- 기사 / 차량 승인
- 요금 조정
- 정산 관리
- 시스템 운영
- 문의 처리 및 관리
- 공지사항 관리

---

## 4. 견적서(Quote) 구조 – 화주 기준

견적서는 **운송 제안서**이며, 다음 정보를 포함한다.

- 출발지 / 도착지
- 화물 무게 / 부피
- 희망 금액
- 체크리스트 조건
- ✅ **합짐 가능 여부 (중요)**

### 합짐 가능 여부의 의미

- ❌ 체크 안 함 → 단건 운송만 허용
- ⭕ 체크 함 → 기사 다건 운송 조합 대상 가능

 합짐은 **화주 동의 없이는 절대 발생하지 않음**

---

## 5. 기사 견적 추천 구조 (핵심 기능)

기사는 **운송을 시작하기 전**, 견적 리스트를 기반으로  
본인의 차량 상태에 맞는 운송을 계획한다.

### 추천 유형 3가지

#### ① 일반 추천 (단건)
- 기본 운송
- 즉시 수락

#### ② 알뜰배달 추천 (합짐)
- 화주가 합짐 허용한 견적만 대상
- 기사 차량 적재 용량 기준
- 복수 견적 조합 추천

#### ③ 귀가 노선 추천
- 기사 선호 지역(집) 기준
- 귀가 동선상 견적 추천
- 단건 또는 다건 가능

---

## 6. 가격 협상 기능 (조건부)

가격 협상은 **기본 흐름이 아니다.**

### 협상 발생 조건

- 견적 금액이 기사 최소 수익 기준 미달
- 합짐/귀가노선 대비 수익 부족
### 흐름

`견적서  → 기사 협상 요청 (예외)  → 화주 수락  → 매칭 생성`

---

## 7. 매칭(Matching) 구조 – 계약의 시작

매칭은 다음을 의미한다.

- 기사와 화주가 조건에 합의
- 운송 계약 성립
- 이후 모든 흐름의 기준

### 중요한 원칙

- **합짐이어도 매칭은 견적 1개당 1개**
- 다건 운송은 “운영상 개념”
- DB에서는 매칭 독립성 유지

---

## 8. 결제 구조 – 매칭 후 결제

- 선결제 ❌
- 매칭 확정 후 결제 ⭕
- 결제는 매칭 기준

### 장점

- 협상 완료 금액으로 결제
- 계약 안정성
- 취소/환불 단순화

---

## 9. 운송 및 GPS 추적

### GPS 구조

- 실시간 위치 로그

---

## 10. 체크리스트 이행 관리

- 견적서 단계에서 조건 명시
- 운송 완료 후 이행 확인
- 미이행 시 정산 조정 가능

---

## 11. 정산 구조

정산은 운송 완료 후 수행된다.

정산 요소:
- 결제 금액
- 플랫폼 수수료
- 기사 실수령액

---

## 12. 대시보드 구조

### 화주
- 주문 / 배차 / 운행 상태
- 누적 비용

### 기사
- 운행 시간
- 운송 건수
- 누적 수익

---

## 13. 전체 흐름 요약

 `[화주] 견적 등록 (합짐 허용 선택)  → 기사 선택/협상 수락  → 매칭 확정  → 결제  → 운송 확인  → 이행 확인  → 정산  
`` [기사] 견적 리스트 조회  → 차량 용량 기반 단건/다건 계획  → 합짐·귀가노선 선택  → (필요 시 협상)  → 매칭  → 운송  → GPS 전송  → 수익 확인`

---
